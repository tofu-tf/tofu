"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5408],{5680:(e,n,t)=>{t.d(n,{xA:()=>p,yg:()=>m});var a=t(6540);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function g(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=a.createContext({}),s=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},p=function(e){var n=s(e.components);return a.createElement(l.Provider,{value:n},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,p=g(e,["components","mdxType","originalType","parentName"]),c=s(t),u=i,m=c["".concat(l,".").concat(u)]||c[u]||d[u]||o;return t?a.createElement(m,r(r({ref:n},p),{},{components:t})):a.createElement(m,r({ref:n},p))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var o=t.length,r=new Array(o);r[0]=u;var g={};for(var l in n)hasOwnProperty.call(n,l)&&(g[l]=n[l]);g.originalType=e,g[c]="string"==typeof e?e:i,r[1]=g;for(var s=2;s<o;s++)r[s]=t[s];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},3746:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>l,default:()=>m,frontMatter:()=>g,metadata:()=>s,toc:()=>c});var a=t(8168),i=t(8587),o=(t(6540),t(5680)),r=["components"],g={id:"tofu.logging.main.entities",title:"Core concepts"},l="tofu.logging core concepts",s={unversionedId:"tofu.logging.main.entities",id:"tofu.logging.main.entities",title:"Core concepts",description:"tofu.logging consists of three main things:",source:"@site/../docs/tofu.logging.main.entities.md",sourceDirName:".",slug:"/tofu.logging.main.entities",permalink:"/tofu/docs/tofu.logging.main.entities",draft:!1,tags:[],version:"current",lastUpdatedBy:"Vadim Chelyshov",lastUpdatedAt:1739301814,formattedLastUpdatedAt:"Feb 11, 2025",frontMatter:{id:"tofu.logging.main.entities",title:"Core concepts"},sidebar:"docs",previous:{title:"Home (Start here)",permalink:"/tofu/docs/tofu.logging.home"},next:{title:"Key Features",permalink:"/tofu/docs/tofu.logging.key-features"}},p={},c=[{value:"Typeclass <code>Loggable[A]</code>",id:"typeclass-loggablea",level:2},{value:"Derivation",id:"derivation",level:2},{value:"Configured derivation",id:"configured-derivation",level:3},{value:"Logging",id:"logging",level:2},{value:"Logs",id:"logs",level:2},{value:"Logging.Make",id:"loggingmake",level:3}],d={toc:c},u="wrapper";function m(e){var n=e.components,t=(0,i.A)(e,r);return(0,o.yg)(u,(0,a.A)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,o.yg)("h1",{id:"tofulogging-core-concepts"},"tofu.logging core concepts"),(0,o.yg)("p",null,(0,o.yg)("inlineCode",{parentName:"p"},"tofu.logging")," consists of three main things:"),(0,o.yg)("h2",{id:"typeclass-loggablea"},"Typeclass ",(0,o.yg)("inlineCode",{parentName:"h2"},"Loggable[A]")),(0,o.yg)("p",null,"This is a type class that describes how an arbitrary instance of type A should be presented in the log messages."),(0,o.yg)("h2",{id:"derivation"},"Derivation"),(0,o.yg)("p",null,"Loggable instances could be derived automatically using ",(0,o.yg)("inlineCode",{parentName:"p"},"derevo"),":"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-scala"},"import tofu.logging.derivation._\nimport derevo.derive\n\n@derive(loggable)\ncase class Data(id: Long, weight: Int, name: String)\n\n")),(0,o.yg)("p",null,"This annotation puts the instance of ",(0,o.yg)("inlineCode",{parentName:"p"},"Loggable[Data]")," into the (generated if not present) companion object ",(0,o.yg)("inlineCode",{parentName:"p"},"Data"),". When\nthe message is logged, the fields of ",(0,o.yg)("inlineCode",{parentName:"p"},"Data")," will be put into the result (e.g. JSON)."),(0,o.yg)("h3",{id:"configured-derivation"},"Configured derivation"),(0,o.yg)("p",null,"This derivation can be configured with annotations ",(0,o.yg)("inlineCode",{parentName:"p"},"hidden"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"masked")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"unembed"),":"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-scala"},"import tofu.logging.derivation._\nimport derevo.derive\n\n@derive(loggable)\ncase class ClientData(name: String, surname: String)\n\n@derive(loggable)\ncase class Payment(id: Long, @masked(MaskMode.Erase) cardNumber: String, @unembed name: ClientData)\n\n")),(0,o.yg)("p",null,"A message ",(0,o.yg)("inlineCode",{parentName:"p"},'info"This is $payment"')," would look like that:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "@timestamp": "2021-08-20T17:13:39.787Z",\n  "loggerName": "some-logger",\n  "threadName": "ioapp-compute-0",\n  "level": "INFO",\n  "message": "This is Payment: Payment{id=3234,cardNumber=...,name=ClientData{name=foo,surname=bar}}",\n  "id": 3234,\n  "cardNumber": "...",\n  "name": "foo",\n  "surname": "bar"\n}\n')),(0,o.yg)("h2",{id:"logging"},"Logging"),(0,o.yg)("p",null,(0,o.yg)("inlineCode",{parentName:"p"},"Logging[F]")," is a trait that describes logging capabilities of ",(0,o.yg)("inlineCode",{parentName:"p"},"F"),"."),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-scala"},"trait Logging[F[_]] {\n  def info(message: String, values: LoggedValue*): F[Unit]\n  //...\n}\n\n")),(0,o.yg)("p",null,"It has a tagged version ",(0,o.yg)("inlineCode",{parentName:"p"},"ServiceLogging[F, Service]")," which can be used for some ",(0,o.yg)("inlineCode",{parentName:"p"},"Service")," and carry this information on\nthe typelevel."),(0,o.yg)("h2",{id:"logs"},"Logs"),(0,o.yg)("p",null,"Trait ",(0,o.yg)("inlineCode",{parentName:"p"},"Logs[I, F]")," is a factory of the ",(0,o.yg)("inlineCode",{parentName:"p"},"Logging[F]")," instances which decides how created Logging will behave."),(0,o.yg)("p",null,"As the creation of arbitrary logging instance could potentially have some side effects, operations of this trait are\neffectual:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-scala"},"trait Logs[I[_], F[_]] {\n  def byName(name: String): I[Logging[F]]\n\n  def forService[Svc]: I[Logging[F]]\n  //...\n}\n\n")),(0,o.yg)("p",null,"The name method parameter (or type tag for ",(0,o.yg)("inlineCode",{parentName:"p"},"Svc")," type parameter) is used in the underlying logger and then displayed in\nthe log messages."),(0,o.yg)("h3",{id:"loggingmake"},"Logging.Make"),(0,o.yg)("p",null,"Nevertheless, some Logging instances can be created safely with no side effects, so one could use ",(0,o.yg)("inlineCode",{parentName:"p"},"Logging.Make"),"\nwhich creates plain ",(0,o.yg)("inlineCode",{parentName:"p"},"Logging[F]"),". It uses the default backend by ",(0,o.yg)("inlineCode",{parentName:"p"},"Slf4j")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"Delay")," typeclass."))}m.isMDXComponent=!0}}]);